<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Storyline App</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#2196F3">

  <!-- Firebase -->
  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js';
    import { getFirestore } from 'https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js';

    const firebaseConfig = {
      apiKey: "AIzaSyAjxr-5XZgYWKsUwPskXQc5WxzOqtR5pnY",
      authDomain: "story-line-d2849.firebaseapp.com",
      projectId: "story-line-d2849",
      storageBucket: "story-line-d2849.firebasestorage.app",
      messagingSenderId: "100849395388",
      appId: "1:100849395388:web:8d7410c67b7206957692b9"
    };

    const firebaseApp = initializeApp(firebaseConfig);
    const db = getFirestore(firebaseApp);

    // Make Firebase available globally
    window.firebaseApp = firebaseApp;
    window.db = db;
  </script>
</head>

<body>
  <div class="app">
    <header class="header">
      <h1>ğŸ“– Storyline</h1>
      <button id="newStoryBtn" class="btn btn-primary">+ New Story</button>
    </header>

    <main class="main">
      <!-- Story List View -->
      <div id="storyListView" class="view active">
        <div class="sync-controls">
          <button id="syncToCloudBtn" class="btn btn-sync">â¬†ï¸ Upload</button>
          <button id="syncFromCloudBtn" class="btn btn-sync">â¬‡ï¸ Downlad</button>
          <button id="clearCacheBtn" class="btn btn-cache">â« Update App</button>
        </div>

        <div class="search-section">
          <div class="search-container">
            <input type="text" id="searchInput" placeholder="ğŸ” Search stories..." class="search-input">
            <button id="clearSearchBtn" class="search-clear" style="display: none;">Ã—</button>
          </div>
        </div>

        <div id="storyList" class="story-list"></div>
      </div>

      <!-- Story Editor View -->
      <div id="storyEditorView" class="view">
        <div class="editor-header">
          <button id="backBtn" class="btn btn-secondary">â† Back</button>
          <button id="previewBtn" class="btn btn-secondary">ğŸ‘ï¸ Preview</button>
          <button id="editBtn" class="btn btn-secondary" style="display: none;">âœï¸ Edit</button>
          <button id="notesBtn" class="btn btn-secondary">ğŸ“ Notes</button>
          <button id="saveStoryBtn" class="btn btn-primary">Save</button>
          <button id="deleteStoryBtn" class="btn btn-danger">Delete</button>
        </div>

        <!-- Edit Mode -->
        <div id="editMode" class="story-form">
          <input type="text" id="storyTitle" placeholder="Story Title" class="input-field">

          <div class="auto-save-toggle">
            <label class="toggle-label">
              <input type="checkbox" id="autoSaveToggle" class="toggle-input">
              <span class="toggle-slider"></span>
              <span class="toggle-text">Auto Save</span>
            </label>
          </div>

          <div class="paragraphs-section">
            <div class="section-header">
              <h3>Paragraphs</h3>
              <div class="section-controls">
                <button id="expandAllBtn" class="btn btn-small">Expand All</button>
                <button id="collapseAllBtn" class="btn btn-small">Collapse All</button>
              </div>
            </div>

            <div class="paragraph-search-section">
              <div class="paragraph-search-container">
                <input type="text" id="paragraphSearchInput" placeholder="ğŸ” Search paragraphs..."
                  class="paragraph-search-input">
                <button id="clearParagraphSearchBtn" class="paragraph-search-clear" style="display: none;">Ã—</button>
              </div>
            </div>

            <div id="paragraphsList" class="paragraphs-list"></div>
            <div class="add-paragraph-section">
              <button id="addParagraphBtn" class="btn btn-primary">+ Add Paragraph</button>
            </div>
          </div>

          <div class="actions">
            <button id="copyStoryBtn" class="btn btn-secondary">ğŸ“‹ Copy Story</button>
          </div>
        </div>

        <!-- Preview Mode -->
        <div id="previewMode" class="preview-view" style="display: none;">
          <div id="previewContent" class="preview-content"></div>
        </div>
      </div>
    </main>
  </div>

  <!-- Notes Modal -->
  <div id="notesModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>ğŸ“ Story Notes</h2>
        <button id="closeNotesBtn" class="modal-close">Ã—</button>
      </div>
      <div class="modal-body">
        <div id="notesContent" class="notes-content"></div>
      </div>
    </div>
  </div>

  <!-- Paragraph Note Modal -->
  <div id="paragraphNoteModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="noteModalTitle">ğŸ“ Paragraph Notes</h2>
        <button id="closeParagraphNoteBtn" class="modal-close">Ã—</button>
      </div>
      <div class="modal-body">
        <div class="notes-list" id="notesList">
          <!-- Individual notes will be rendered here -->
        </div>
        <div class="add-note-section">
          <textarea id="newNoteTextarea" placeholder="Add a new note..." class="note-textarea"></textarea>
          <div class="note-actions">
            <button id="addNoteBtn" class="btn btn-primary">Add Note</button>
            <button id="cancelNoteBtn" class="btn btn-secondary" style="display: none;">Cancel</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>

</html>